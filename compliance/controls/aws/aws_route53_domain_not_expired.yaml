ID: aws_route53_domain_not_expired
Title: "Route 53 domains should not be expired"
Description: "This control identifes any expired domain names registered with AWS Route 53. When the expired domain names are not restored promptly, they will become available for others to register. Restoring on time your Route 53 expired domains will allow you to reestablish full control over their registration."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  arn as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when expiration_date < (current_date - interval '1' minute) then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when expiration_date < (current_date - interval '1' minute) then title || ' expired on ' || to_char(expiration_date, 'DD-Mon-YYYY') || '.'\n    else title || ' set to expire in ' || extract(day from expiration_date - current_date) || ' days.'\n  end as reason\n  \n  \nfrom\n  aws_route53_domain;"
  PrimaryTable: aws_route53_domain
  ListOfTables:
    - aws_route53_domain
  Parameters: []
Severity: low
Tags: {}
IntegrationTypeName:
  - aws_cloud
