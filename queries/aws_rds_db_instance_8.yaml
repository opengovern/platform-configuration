Description: Allows users to query AWS RDS DB Instances for detailed information about
  the configuration, status, and other metadata associated with each database instance.
ID: aws_rds_db_instance_8
IntegrationType:
- aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: "with db_parameter_group as (\n  select\n    name as db_parameter_group_name,\n\
    \    pg ->> 'ParameterName' as parameter_name,\n    pg ->> 'ParameterValue' as\
    \ parameter_value\n  from\n    aws_rds_db_parameter_group,\n    jsonb_array_elements(parameters)\
    \ as pg\n  where\n    -- The example is limited to SQL Server, this may change\
    \ based on DB engine\n    pg ->> 'ParameterName' like 'rds.force_ssl'\n    and\
    \ name not like 'default.%'\n),\n rds_associated_parameter_group as (\n  select\n\
    \    db_instance_identifier as db_instance_identifier,\n    arn,\n    pg ->> 'DBParameterGroupName'\
    \ as DBParameterGroupName\n  from\n    aws_rds_db_instance,\n    jsonb_array_elements(db_parameter_groups)\
    \ as pg\n  where\n    engine like 'sqlserve%'\n)\nselect\n  rds.db_instance_identifier\
    \ as name,\n  rds.DBParameterGroupName,\n  parameter_name,\n  parameter_value\n\
    from\n  rds_associated_parameter_group as rds\n  left join db_parameter_group\
    \ d on rds.DBParameterGroupName = d.db_parameter_group_name\nwhere\n  parameter_value\
    \ = '0'"
Tags:
  cloud_network_security:
  - 'true'
  cloud_ops:
  - 'true'
  cloud_provider:
  - aws
  cloud_service:
  - RDS
Title: List All AWS RDS DB Instances with SSL Parameter Details
