ID: aws_foundational_security_ec2_3
Title: "3 Attached EBS volumes should be encrypted at rest"
Description: "This control checks whether the EBS volumes that are in an attached state are encrypted. To pass this check, EBS volumes must be in use and encrypted. If the EBS volume is not attached, then it is not subject to this check."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  arn as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when state != 'in-use' then 'skip'\n    when encrypted then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when state != 'in-use' then volume_id || ' not attached.'\n    when encrypted then volume_id || ' encrypted.'\n    else volume_id || ' not encrypted.'\n  end as reason\n  \n  \nfrom\n  aws_ebs_volume;"
  PrimaryTable: aws_ebs_volume
  ListOfTables:
    - aws_ebs_volume
  Parameters: []
Severity: medium
Tags: {}
Integration_Type_Name:
  - aws_cloud
