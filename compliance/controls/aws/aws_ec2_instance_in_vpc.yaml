ID: aws_ec2_instance_in_vpc
Title: "EC2 instances should be in a VPC"
Description: "Deploy AWS Elastic Compute Cloud (AWS EC2) instances within an AWS Virtual Private Cloud (AWS VPC) to enable secure communication between an instance and other services within the amazon VPC, without requiring an internet gateway, NAT device, or VPN connection."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  arn as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when vpc_id is null then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when vpc_id is null then title || ' not in VPC.'\n    else title || ' in VPC.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_ec2_instance;\n"
  PrimaryTable: aws_ec2_instance
  ListOfTables:
    - aws_ec2_instance
  Parameters: []
Severity: medium
Tags:
  category:
    - Compliance
  cis_controls_v8_ig1:
    - "true"
  cisa_cyber_essentials:
    - "true"
  fedramp_low_rev_4:
    - "true"
  fedramp_moderate_rev_4:
    - "true"
  ffiec:
    - "true"
  gxp_21_cfr_part_11:
    - "true"
  hipaa_final_omnibus_security_rule_2013:
    - "true"
  hipaa_security_rule_2003:
    - "true"
  nist_800_171_rev_2:
    - "true"
  nist_800_53_rev_4:
    - "true"
  nist_800_53_rev_5:
    - "true"
  nist_csf:
    - "true"
  pci_dss_v321:
    - "true"
  plugin:
    - aws
  rbi_cyber_security:
    - "true"
  score_tags:
    - Exposed Endpoints
  service:
    - AWS/EC2
  soc_2:
    - "true"
Integration_Type_Name:
  - aws_cloud
