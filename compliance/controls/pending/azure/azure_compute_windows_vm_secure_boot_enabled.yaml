ID: azure_compute_windows_vm_secure_boot_enabled
Title: "Secure Boot should be enabled on supported Windows virtual machines"
Description: "Enable Secure Boot on supported Windows virtual machines to mitigate against malicious and unauthorized changes to the boot chain. Once enabled, only trusted bootloaders, kernel and kernel drivers will be allowed to run. This assessment applies to Trusted Launch and Confidential Windows virtual machines."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  a.id as resource,\n  case\n    when image_offer not like '%Windows%' or os_type not like 'Windows%' then 'skip'\n    when security_profile ->> 'securityType' in ('TrustedLaunch','ConfidentialVM') and security_profile ->> 'uefiSettings' is not null and security_profile -> 'uefiSettings' ->> 'secureBootEnabled' = 'true' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when image_offer not like '%Windows%' or os_type not like 'Windows%' then a.title || ' is not a windows VM.'\n    when security_profile ->> 'securityType' in ('TrustedLaunch','ConfidentialVM') and security_profile ->> 'uefiSettings' is not null and security_profile -> 'uefiSettings' ->> 'secureBootEnabled' = 'true' then a.title || ' secure boot enabled.'\n    else a.title || ' secure boot disabled.'\n  end as reason\n  \n  \n  \nfrom\n  azure_compute_virtual_machine as a,\n  azure_subscription as sub\nwhere\n  sub.subscription_id = a.subscription_id\n"
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Severity: low
Tags: {}
IntegrationTypeName:
  - azure_subscription
