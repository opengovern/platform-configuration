Description: Allows users to query Cost and Usage data from AWS Cost Explorer Service
  to monitor, track, and manage AWS costs and usage over time.
ID: aws_cost_usage_2
IntegrationTypeName:
- aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: "with ranked_costs as (\n  select\n    dimension_1 as account_id,\n\
    \    dimension_2 as service_name,\n    sum(net_unblended_cost_amount)::numeric::money\
    \ as net_unblended_cost,\n    rank() over(partition by dimension_1 order by sum(net_unblended_cost_amount)\
    \ desc)\n  from\n    aws_cost_usage\n  where\n    granularity = 'MONTHLY'\n  \
    \  and dimension_type_1 = 'LINKED_ACCOUNT'\n    and dimension_type_2 = 'SERVICE'\n\
    \  group by\n    dimension_1,\n    dimension_2\n  order by\n    dimension_1,\n\
    \    net_unblended_cost desc\n)\nselect * from ranked_costs where rank <=5"
Tags:
  cloud_asset_management:
  - 'true'
  cloud_finops:
  - 'true'
  cloud_ops:
  - 'true'
  cloud_provider:
  - aws
  cloud_service:
  - Cost Explorer
Title: List Top 5 AWS Cost and Usage Data
