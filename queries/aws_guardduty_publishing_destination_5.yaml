Description: Allows users to query AWS GuardDuty Publishing Destinations to retrieve
  information about where GuardDuty findings are published.
ID: aws_guardduty_publishing_destination_5
IntegrationType:
- aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: "select\n  d.destination_id,\n  d.destination_arn,\n  d.destination_type,\n\
    \  p ->> 'Sid' as sid,\n  p ->> 'Action' as policy_action,\n  p ->> 'Effect' as\
    \ effect,\n  p -> 'Principal' ->> 'Service' as principal_service\nfrom\n  aws_guardduty_publishing_destination\
    \ as d,\n  aws_s3_bucket as s,\n  jsonb_array_elements(s.policy -> 'Statement')\
    \ as p\nwhere\n  d.destination_type = 'S3'\nand\n  s.arn = d.destination_arn;"
Tags:
  cloud_asset_management:
  - 'true'
  cloud_provider:
  - aws
  cloud_service:
  - GuardDuty
Title: Find AWS GuardDuty Publishing Destinations
