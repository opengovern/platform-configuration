ID: azure_cis_v210_3_17
Title: "3.17 Ensure that `Allow Blob Anonymous Access` is set to `Disabled`"
Description: "The Azure Storage setting 'Allow Blob Anonymous Access' (aka 'allowBlobPublicAccess') controls whether anonymous access is allowed for blob data in a storage account. When this property is set to True, it enables public read access to blob data, which can be convenient for sharing data but may carry security risks. When set to False, it disallows public access to blob data, providing a more secure storage environment."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  container.id as resource,\n  case\n    when not account.allow_blob_public_access and container.public_access = 'None' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when not account.allow_blob_public_access and container.public_access = 'None'\n      then account.name || ' container ' || container.name || ' doesn''t allow anonymous access.'\n    else account.name || ' container ' || container.name || ' allows anonymous access.'\n  end as reason\n  \n  \n  \nfrom\n  azure_storage_container container\n  join azure_storage_account account on container.account_name = account.name\n  join azure_subscription sub on sub.subscription_id = account.subscription_id;\n"
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Severity: low
Tags: {}
Integration_Type_Name:
  - azure_subscription
