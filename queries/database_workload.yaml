Description: ""
ID: database_workload
IntegrationType:
  - aws_cloud_account
  - azure_subscription
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: |
    SELECT
      CASE
        WHEN resource_type LIKE 'aws::%' THEN 'AWS'
        ELSE 'Azure'
      END AS provider,
      c.name AS cloud_account_name,
      c.id AS _discovered_provider_id,
      r.name AS name,
      r.region AS location,
      r.connection_id AS _og_connection_id,
      r.resource_id AS _resource_id,
      r.resource_type AS _resource_type,
      r.created_at AS _last_discovered
    FROM
      platform_resources r
    INNER JOIN
      og_connections c
    ON
      r.connection_id = c.og_id
    WHERE
      resource_type IN (
        'aws::memorydb::cluster', 
        'aws::neptune::database', 
        'aws::dynamodb::table', 
        'aws::rds::dbinstance', 
        'aws::elasticache::cluster', 
        'aws::redshift::cluster', 
        'aws::dms::replicationinstance', 
        'aws::redshiftserverless::namespace', 
        'aws::opensearchserverless::collection', 
        'microsoft.dbforpostgresql/servers', 
        'microsoft.documentdb/sqldatabases', 
        'microsoft.sql/servers', 
        'microsoft.dbformysql/servers', 
        'microsoft.sql/managedinstances'
      )
Tags:
  cloud_asset_management:
    - "true"
  cloud_provider:
    - aws
    - azure
  cloud_service:
    - Database
Title: List Database Workloads and Cloud Provider Information