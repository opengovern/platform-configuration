ID: aws_cis_v140_1_14
Title: "1.14 Ensure access keys are rotated every 90 days or less"
Description: "Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  'arn:' || partition || ':iam::' || account_id || ':user/' || user_name || '/accesskey/' || access_key_id as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when create_date <= (current_date - interval '90' day) then 'alarm'\n    else 'ok'\n  end status,\n  user_name || ' ' || access_key_id || ' created ' || to_char(create_date , 'DD-Mon-YYYY') ||\n    ' (' || extract(day from current_timestamp - create_date) || ' days).'\n  as reason\n  \nfrom\n  aws_iam_access_key;"
  PrimaryTable: aws_iam_access_key
  ListOfTables:
    - aws_iam_access_key
  Parameters: []
Severity: low
Tags: {}
IntegrationTypeName:
  - aws_cloud
