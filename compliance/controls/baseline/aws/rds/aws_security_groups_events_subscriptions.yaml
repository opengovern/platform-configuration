ID: aws_security_groups_events_subscriptions
Title: "Security Groups Events Subscriptions"
Description: "Enable Event Subscriptions for DB Security Groups Events."
Query:
  Engine: odysseus-v0.0.1
  QueryToExecute: "select distinct\n  a.og_account_id,\n  a.og_resource_id,\n  case\n    when s.arn\n    is null then 'alarm'\n    else 'ok'\n  end status,\n  case\n    when s.arn is\n    null then 'Event subscription is not enabled for database security groups'\n    else\n    'Event subscription is enabled for database security groups'\n  end reason,\n\n    a.account_id\nfrom \n  aws_account a\n  left join (select * from aws_rds_db_event_subscription\n    where source_type = 'db-security-group') s on s.og_account_id = a.og_account_id\n"
  PrimaryTable: aws_account
  ListOfTables:
    - aws_account
    - aws_rds_db_event_subscription
  Parameters: []
Severity: high
Tags:
  platform_score_cloud_service_name:
    - AWS Relational Database Service (RDS)
  platform_score_use_case:
    - General Efficiency
  score_service_name:
    - AWS Relational Database Service (RDS)
  score_tags:
    - General Efficiency
IntegrationTypeName:
  - aws_cloud
