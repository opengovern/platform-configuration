ID: aws_redshift_cluster_kms_enabled
Title: "AWS Redshift clusters should be encrypted with KMS"
Description: "Ensure that AWS Redshift clusters are using a specified AWS Key Management Service (AWS KMS) key for encryption. The rule is compliant if encryption is enabled and the cluster is encrypted with the key provided in the kmsKeyArn parameter. The rule is non-compliant if the cluster is not encrypted or encrypted with another key."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  arn as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when encrypted and kms_key_id is not null then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when encrypted and kms_key_id is not null then title || ' encrypted with KMS.'\n    else title || ' not encrypted with KMS'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_redshift_cluster;\n"
  PrimaryTable: aws_redshift_cluster
  ListOfTables:
    - aws_redshift_cluster
  Parameters: []
Severity: high
Tags:
  category:
    - Compliance
  cisa_cyber_essentials:
    - "true"
  fedramp_low_rev_4:
    - "true"
  fedramp_moderate_rev_4:
    - "true"
  ffiec:
    - "true"
  gxp_21_cfr_part_11:
    - "true"
  hipaa_final_omnibus_security_rule_2013:
    - "true"
  hipaa_security_rule_2003:
    - "true"
  nist_800_53_rev_5:
    - "true"
  nist_csf:
    - "true"
  plugin:
    - aws
  rbi_cyber_security:
    - "true"
  service:
    - AWS/Redshift
IntegrationTypeName:
  - aws_cloud_account
