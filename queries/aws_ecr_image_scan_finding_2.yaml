Description: Allows users to query Amazon ECR Image Scan Findings to retrieve detailed
  information about image scan findings, including attributes such as the severity
  of the finding, description, and package name where the vulnerability was found.
ID: aws_ecr_image_scan_finding_2
IntegrationTypeName:
- aws_cloud
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: "select\n  f.repository_name,\n  f.image_tag,\n  f.name,\n  f.severity,\n\
    \  jsonb_pretty(f.attributes) as attributes\nfrom\n  (\n    select\n      repository_name,\n\
    \      jsonb_array_elements_text(image_tags) as image_tag\n    from\n      aws_ecr_image\
    \ as i\n    where\n      i.image_pushed_at > now() - interval '24' hour\n  )\n\
    \  images\n  left outer join\n    aws_ecr_image_scan_finding as f\n    on images.repository_name\
    \ = f.repository_name\n    and images.image_tag = f.image_tag;"
Tags:
  cloud_asset_management:
  - 'true'
  cloud_provider:
  - aws
  cloud_service:
  - Amazon ECR
Title: Find Amazon ECR Image Scan Findings for Recent Images
