Description: The Azure Storage setting 'Allow Blob Anonymous Access' (aka 'allowBlobPublicAccess') controls whether anonymous access is allowed for blob data in a storage account. When this property is set to True, it enables public read access to blob data, which can be convenient for sharing data but may carry security risks. When set to False, it disallows public access to blob data, providing a more secure storage environment.
ID: azure_cis_v210_3_17
IntegrationType:
  - azure_subscription
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: ""
  QueryToExecute: |
    SELECT
      container.id AS resource,
      CASE
        WHEN NOT account.allow_blob_public_access AND container.public_access = 'None' THEN 'ok'
        ELSE 'alarm'
      END AS status,
      CASE
        WHEN NOT account.allow_blob_public_access AND container.public_access = 'None' THEN 
          account.name || ' container ' || container.name || ' doesn''t allow anonymous access.'
        ELSE
          account.name || ' container ' || container.name || ' allows anonymous access.'
      END AS reason
    FROM
      azure_storage_container container
    JOIN
      azure_storage_account account ON container.account_name = account.name
    JOIN
      azure_subscription sub ON sub.subscription_id = account.subscription_id;
Severity: low
Tags: {}
Title: 3.17 Ensure that `Allow Blob Anonymous Access` is set to `Disabled`