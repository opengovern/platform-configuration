Description: IAM password policies can require passwords to be rotated or expired after a given number of days. Security Hub recommends that the password policy expire passwords after 90 days or less. Reducing the password lifetime increases account resiliency against brute force login attempts.
ID: aws_iam_password_policy_expire_90
IntegrationType:
  - aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: ""
  QueryToExecute: |
    SELECT
      'arn:' || a.partition || ':::' || a.account_id AS resource,
      CASE
        WHEN max_password_age <= 90 THEN 'ok'
        ELSE 'alarm'
      END AS status,
      CASE
        WHEN max_password_age IS NULL THEN 'Password expiration not set.'
        ELSE 'Password expiration set to ' || max_password_age || ' days.'
      END AS reason
    FROM
      aws_account AS a
    LEFT JOIN
      aws_iam_account_password_policy AS pol ON a.account_id = pol.account_id;
Severity: low
Tags: {}
Title: Ensure IAM password policy expires passwords within 90 days or less