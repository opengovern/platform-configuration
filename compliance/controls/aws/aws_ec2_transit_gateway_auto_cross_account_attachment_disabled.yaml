ID: aws_ec2_transit_gateway_auto_cross_account_attachment_disabled
Title: "EC2 transit gateways should have auto accept shared attachments disabled"
Description: "Ensure transit gateways have auto accept shared attachments feature disabled. If this setting is disabled, then any VPC that attempts to attach to a transit gateway will need to request authorization, and the account that owns the transit gateway will need to accept the authorization."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  transit_gateway_arn as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when auto_accept_shared_attachments = 'enable' then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when auto_accept_shared_attachments = 'enable' then title || ' automatic shared account attachment enabled.'\n    else title || ' automatic shared account attachment disabled.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_ec2_transit_gateway;\n"
  PrimaryTable: aws_ec2_transit_gateway
  ListOfTables:
    - aws_ec2_transit_gateway
  Parameters: []
Severity: high
Tags:
  aws_foundational_security:
    - "true"
  category:
    - Compliance
  foundational_security_category:
    - secure_network_configuration
  foundational_security_item_id:
    - ec2_23
  plugin:
    - aws
  service:
    - AWS/EC2
IntegrationType:
  - aws_cloud_account
