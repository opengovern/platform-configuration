ID: azure_securitycenter_azure_defender_on_for_dns
Title: "Azure Defender for DNS should be enabled"
Description: "Azure Defender for DNS provides an additional layer of protection for your cloud resources by continuously monitoring all DNS queries from your Azure resources. Azure Defender alerts you about suspicious activity at the DNS layer."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  sub_pricing.id as resource,\n  sub_pricing.og_account_id as og_account_id,\n  sub_pricing.og_resource_id as og_resource_id,\n  case\n    when pricing_tier = 'Standard' then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when pricing_tier = 'Standard' then 'Azure Defender on for DNS.'\n    else 'Azure Defender off for DNS.'\n  end as reason\n  \n  , sub.display_name as subscription\nfrom\n  azure_security_center_subscription_pricing sub_pricing\n  right join azure_subscription sub on sub_pricing.subscription_id = sub.subscription_id\nwhere\n  name = 'Dns';\n"
  PrimaryTable: azure_security_center_subscription_pricing
  ListOfTables:
    - azure_security_center_subscription_pricing
    - azure_subscription
  Parameters: []
Severity: medium
Tags:
  category:
    - Compliance
  cis:
    - "true"
  cis_item_id:
    - 2.1.11
  cis_level:
    - "2"
  cis_section_id:
    - "2.1"
  cis_type:
    - manual
  cis_version:
    - v1.5.0
  plugin:
    - azure
  service:
    - Azure/SecurityCenter
IntegrationTypeName:
  - azure_subscription
