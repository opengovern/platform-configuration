Description: Ensure logging is enabled for task definitions so that you can access your containerized application logs for debugging and auditing purposes. On top of centralized logging, these log drivers often include additional capabilities that are useful for operation.
ID: aws_ecs_task_definition_logging_enabled
IntegrationType:
  - aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables:
    - aws_ecs_task_definition
  Parameters: []
  PrimaryTable: aws_ecs_task_definition
  QueryToExecute: |
    WITH task_definitions_logging_enabled AS (
      SELECT
        DISTINCT task_definition_arn AS arn
      FROM
        aws_ecs_task_definition,
        jsonb_array_elements(container_definitions) AS c
      WHERE
        c ->> 'LogConfiguration' IS NOT NULL
    )
    SELECT
      a.task_definition_arn AS resource,
      a.platform_account_id AS platform_account_id,
      a.platform_resource_id AS platform_resource_id,
      CASE
        WHEN b.arn IS NOT NULL THEN 'ok'
        ELSE 'alarm'
      END AS status,
      CASE
        WHEN b.arn IS NOT NULL THEN a.title || ' logging enabled.'
        ELSE a.title || ' logging disabled.'
      END AS reason
    FROM
      aws_ecs_task_definition AS a
    LEFT JOIN task_definitions_logging_enabled AS b
      ON a.task_definition_arn = b.arn;
Severity: low
Tags: {}
Title: ECS task definitions should have logging enabled