Description: Allows users to query AWS IAM Credential Reports, providing a comprehensive
  overview of the AWS Identity and Access Management (IAM) users, their status, and
  credential usage.
ID: aws_iam_credential_report_4
IntegrationType:
- aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: "select\n  user_name,\n  access_key_1_last_rotated,\n  age(access_key_1_last_rotated)\
    \ as access_key_1_age,\n  access_key_2_last_rotated,\n  age(access_key_2_last_rotated)\
    \ as access_key_2_age\nfrom\n  aws_iam_credential_report\nwhere\n  access_key_1_last_rotated\
    \ <= (current_date - interval '90' day)\n  or access_key_2_last_rotated <= (current_date\
    \ - interval '90' day)\norder by\n  user_name;"
Tags:
  cloud_identity_security:
  - 'true'
  cloud_provider:
  - aws
  cloud_service:
  - Identity and Access Management (IAM)
Title: Find all AWS IAM Credential Reports for Key Rotation
