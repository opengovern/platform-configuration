Description: This control checks whether enhanced monitoring is enabled for your RDS DB instances. In Amazon RDS, Enhanced Monitoring enables a more rapid response to performance changes in underlying infrastructure. These performance changes could result in a lack of availability of the data. Enhanced Monitoring provides real-time metrics of the operating system that your RDS DB instance runs on. An agent is installed on the instance. The agent can obtain metrics more accurately than is possible from the hypervisor layer.
ID: aws_foundational_security_rds_6
IntegrationType:
  - aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: ""
  QueryToExecute: |
    (
    SELECT
      arn AS resource,
      CASE
        WHEN enabled_cloudwatch_logs_exports IS NOT NULL THEN 'ok'
        ELSE 'alarm'
      END AS status,
      CASE
        WHEN enabled_cloudwatch_logs_exports IS NOT NULL THEN title || ' enhanced monitoring enabled.'
        ELSE title || ' enhanced monitoring not enabled.'
      END AS reason
    FROM
      aws_rds_db_cluster
    )
    UNION
    (
    SELECT
      arn AS resource,
      CASE
        WHEN class = 'db.m1.small' THEN 'skip'
        WHEN enhanced_monitoring_resource_arn IS NOT NULL THEN 'ok'
        ELSE 'alarm'
      END AS status,
      CASE
        WHEN class = 'db.m1.small' THEN title || ' enhanced monitoring not supported.'
        WHEN enhanced_monitoring_resource_arn IS NOT NULL THEN title || ' enhanced monitoring enabled.'
        ELSE title || ' enhanced monitoring not enabled.'
      END AS reason
    FROM
      aws_rds_db_instance
    );
Severity: low
Tags: {}
Title: 6 Enhanced monitoring should be configured for RDS DB instances and clusters