ID: aws_foundational_security_cloudfront_13
Title: "13 CloudFront distributions should use origin access control"
Description: "This control checks whether an Amazon CloudFront distribution with an Amazon S3 origin has origin access control (OAC) configured. The control fails if OAC isn't configured for the CloudFront distribution."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  arn as resource,\n  case\n    when o ->> 'DomainName' not like '%s3.amazonaws.com' then 'skip'\n    when o ->> 'DomainName' like '%s3.amazonaws.com'\n    and o -> 'S3OriginConfig' ->> 'OriginAccessIdentity' = '' then 'alarm'\n    else 'ok'\n  end as status,\n  case\n    when o ->> 'DomainName' not like '%s3.amazonaws.com' then title || ' origin type is not s3.'\n    when o ->> 'DomainName' like '%s3.amazonaws.com'\n    and o -> 'S3OriginConfig' ->> 'OriginAccessIdentity' = '' then title || ' origin access identity not configured.'\n    else title || ' origin access identity configured.'\n  end as reason\n  \n  \nfrom\n  aws_cloudfront_distribution,\n  jsonb_array_elements(origins) as o;\n"
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Severity: medium
Tags: {}
IntegrationTypeName:
  - aws_cloud
