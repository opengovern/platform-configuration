ID: aws_apigateway_rest_api_stage_xray_tracing_enabled
Title: "API Gateway REST API stages should have AWS X-Ray tracing enabled"
Description: "This control checks whether AWS X-Ray active tracing is enabled for your AWS API Gateway REST API stages."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  arn as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when tracing_enabled then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when tracing_enabled then title || ' X-Ray tracing enabled.'\n    else title || ' X-Ray tracing disabled.'\n  end as reason\n  \n  , region, account_id\nfrom\n  aws_api_gateway_stage;\n"
  PrimaryTable: aws_api_gateway_stage
  ListOfTables:
    - aws_api_gateway_stage
  Parameters: []
Severity: low
Tags:
  aws_foundational_security:
    - "true"
  category:
    - Compliance
  foundational_security_category:
    - detection_services
  foundational_security_item_id:
    - apigateway_3
  plugin:
    - aws
  service:
    - AWS/APIGateway
IntegrationTypeName:
  - aws_cloud_account
