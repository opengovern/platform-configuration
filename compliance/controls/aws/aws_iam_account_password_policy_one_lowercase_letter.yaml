ID: aws_iam_account_password_policy_one_lowercase_letter
Title: "Ensure IAM password policy requires at least one lowercase letter"
Description: "Password policies, in part, enforce password complexity requirements. Use IAM password policies to ensure that passwords use different character sets. Security Hub recommends that the password policy require at least one lowercase letter. Setting a password complexity policy increases account resiliency against brute force login attempts."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: |
    select
      'arn:' || a.partition || ':::' || a.account_id as resource,
      a.og_account_id as og_account_id,
      a.og_resource_id as og_resource_id,
      case
        when require_lowercase_characters then 'ok'
        else 'alarm'
      end as status,
      case
        when minimum_password_length is null then 'No password policy set.'
        when require_lowercase_characters then 'Lowercase character required.'
        else 'Lowercase character not required.'
      end as reason
      , a.account_id
    from
      aws_account as a
      left join aws_iam_account_password_policy as pol on a.account_id = pol.account_id;
  PrimaryTable: aws_account
  ListOfTables:
    - aws_account
    - aws_iam_account_password_policy
  Parameters: []
Severity: low
Tags:
  category:
    - Compliance
  cis:
    - "true"
  cis_item_id:
    - "1.6"
  cis_level:
    - "1"
  cis_section_id:
    - "1"
  cis_type:
    - scored
  cis_version:
    - v1.2.0
  plugin:
    - aws
  service:
    - AWS/IAM
IntegrationTypeName:
  - aws_cloud
