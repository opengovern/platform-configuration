ID: aws_lambda_function_cloudwatch_insights_enabled
Title: "Ensure Cloudwatch Lambda insights is enabled"
Description: "Ensure that Amazon CloudWatch Lambda Insights is enabled for your Amazon Lambda functions for enhanced monitoring."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: "select\n  arn as resource,\n  og_account_id as og_account_id,\n  og_resource_id as og_resource_id,\n  case\n    when exists (\n      select 1\n      from jsonb_array_elements(layers) as l\n      where l ->> 'Arn' like '%:layer:LambdaInsightsExtension:%'\n    ) then 'ok'\n    else 'alarm'\n  end as status,\n  case\n    when exists (\n      select 1\n      from jsonb_array_elements(layers) as l\n      where l ->> 'Arn' like '%:layer:LambdaInsightsExtension:%'\n    ) then title || ' CloudWatch Insights enabled.'\n    else title || ' CloudWatch Insights disabled.'\n  end as reason\n  \n  \nfrom\n  aws_lambda_function;"
  PrimaryTable: aws_lambda_function
  ListOfTables:
    - aws_lambda_function
  Parameters: []
Severity: low
Tags: {}
IntegrationType:
  - aws_cloud_account
