Description: Allows users to query AWS Backup Selections to obtain detailed information
  about the backup selection resources within AWS Backup service.
ID: aws_backup_selection_2
IntegrationType:
- aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: "with filtered_data as (\n  select\n    backup_plan_id,\n    jsonb_agg(r)\
    \ as assigned_resource\n  from\n    aws_backup_selection,\n    jsonb_array_elements(resources)\
    \ as r\n  group by backup_plan_id\n)\nselect\n  v.volume_id,\n  v.region,\n  v.account_id\n\
    from\n  aws_ebs_volume as v\n  join filtered_data t on t.assigned_resource ?|\
    \ array[v.arn];"
Tags:
  cloud_asset_management:
  - 'true'
  cloud_provider:
  - aws
  cloud_service:
  - AWS Backup
Title: List all AWS Backup Selection Details
