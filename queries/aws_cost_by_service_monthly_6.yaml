Description: Allows users to query AWS Cost Explorer Service for monthly cost breakdown
  by service. This table provides details such as the service name, the cost associated
  with it, and the currency code.
ID: aws_cost_by_service_monthly_6
IntegrationTypeName:
- aws_cloud_account
Query:
  Engine: CloudQL-v0.0.1
  ListOfTables: []
  Parameters: []
  PrimaryTable: null
  QueryToExecute: "with cost_data as (\n  select\n    service,\n    period_start,\n\
    \    unblended_cost_amount as this_month,\n    lag(unblended_cost_amount,-1) over(partition\
    \ by service order by period_start desc) as previous_month\n  from \n    aws_cost_by_service_monthly\n\
    )\nselect\n    service,\n    period_start,\n    this_month::numeric::money,\n\
    \    previous_month::numeric::money,\n    case \n      when previous_month = 0\
    \ and this_month = 0  then 0\n      when previous_month = 0 then 999\n      else\
    \ round((100 * ( (this_month - previous_month) / previous_month))::numeric, 2)\
    \ \n    end as percent_change\nfrom\n  cost_data\norder by\n  service,\n  period_start;"
Tags:
  cloud_finops:
  - 'true'
  cloud_provider:
  - aws
  cloud_service:
  - AWS Cost Explorer
Title: List AWS Monthly Cost Breakdown by Service
