ID: azure_monitor_log_cluster_infrastructure_encryption_enabled
Title: "Azure Monitor Logs clusters should be created with infrastructure-encryption enabled (double encryption)"
Description: "To ensure secure data encryption is enabled at the service level and the infrastructure level with two different encryption algorithms and two different keys, use an Azure Monitor dedicated cluster. This option is enabled by default when supported at the region, see https://docs.microsoft.com/azure/azure-monitor/platform/customer-managed-keys#customer-managed-key-overview."
Query:
  Engine: CloudQL-v0.0.1
  QueryToExecute: |-
    select
      id as resource,
      og_account_id as og_account_id,
      og_resource_id as og_resource_id,
      'info' as status,
      'Manual verification required.' as reason,
      display_name as subscription
    from
      azure_subscription;
  PrimaryTable: ""
  ListOfTables: []
  Parameters: []
Severity: low
Tags:
  manual-verification:
    - "true"
IntegrationTypeName:
  - azure_subscription
