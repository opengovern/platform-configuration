control-group:
  id: aws_pci_dss_v321_requirement_2_2_2
  title: 2.2 Enable only necessary services, protocols, daemons, etc., as required for the function of the system
  description: As stated in Requirement 1.1.6, there are many protocols that a business may need (or have enabled by default) that are commonly used by malicious individuals to compromise a network. Including this requirement as part of an organization's configuration standards and related processes ensures that only the necessary services and protocols are enabled.
  section-code: "2"
  metadata:
    defaults:
      auto-assign: null
      enabled: false
      tracks-drift-events: false
    tags: {}
  controls:
  - aws_dms_replication_instance_not_publicly_accessible
  - aws_ebs_snapshot_not_publicly_restorable
  - aws_ec2_instance_in_vpc
  - aws_ec2_instance_not_publicly_accessible
  - aws_eks_cluster_endpoint_restrict_public_access
  - aws_emr_cluster_master_nodes_no_public_ip
  - aws_es_domain_in_vpc
  - aws_lambda_function_in_vpc
  - aws_lambda_function_restrict_public_access
  - aws_rds_db_instance_prohibit_public_access
  - aws_rds_db_snapshot_prohibit_public_access
  - aws_redshift_cluster_prohibit_public_access
  - aws_s3_bucket_restrict_public_read_access
  - aws_s3_public_access_block_account
  - aws_sagemaker_notebook_instance_direct_internet_access_disabled
  - aws_vpc_configured_to_use_vpc_endpoints
  - aws_vpc_igw_attached_to_authorized_vpc
  - aws_vpc_security_group_restrict_ingress_ssh_all
